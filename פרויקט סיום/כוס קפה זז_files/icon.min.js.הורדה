ldc.register("modextIcon",["svgutil"],function(t){var e;return e=t.svgutil,function(t){var i,a,r,n;return i=t,a={id:"editor",type:"modextIcon",edit:{palette:{name:"Palette",type:"palette",priority:2.1},background:{name:"Background",type:"color",default:"#fff",priority:2.2},transparent:{name:"Transparent",type:"boolean",default:!1,priority:2.3},speed:{name:"speed",type:"number",default:.9,priority:2.4,min:.01,max:10,step:.01,exp:{output:.1,input:.5}},size:{name:"size",type:"number",default:47,min:0,max:800,priority:2.5},scale:{name:"scale",type:"number",default:.8,min:0,max:1,step:.01,priority:2.6},animate:{name:"animation",type:"submod",subtype:"animation",default:"breath",priority:3.1,tab:"tertiary"},group:{name:"grouping",type:"choice",default:"No",values:["No","Default Group","Whole Icon"],priority:3.2,tab:"tertiary"},order:{name:"order",type:"choice",default:"Normal",values:["Normal","Reverse","Randomized"],priority:3.3,tab:"tertiary"},origin:{name:"origin",type:"choice",default:"Viewport",values:["Viewport","Image","Layer"],priority:3.4,tab:"tertiary"},dir:{name:"Time Flow",type:"choice",default:"normal",values:["normal","reverse","alternate","alternate-reverse"],priority:3.5,hidden:!1,tab:"tertiary"},latency:{name:"delay",type:"number",min:0,max:1,default:.5,step:.01,priority:3.6,tab:"tertiary"},frameCount:{name:"Frame Rate (fps)",type:"number",default:30,min:1,max:60,priority:3.1,tab:"image"},repeatCount:{name:"Repeat",type:"number",default:0,min:0,max:50,priority:3.2,tab:"image",label:{min:"∞",ptr:function(t){return t||"∞"}},exp:{output:.35,input:.5}},edgeSmoothing:{name:"Smoothing",default:!0,type:"boolean",priority:3.3,tab:"image"},gifGlobalPalette:{type:"boolean",name:"GIF Global Palette",default:!1,priority:4.9,tab:"image"},rotate:{name:"Rotation",type:"number",default:0,min:0,max:360,priority:4.1,tab:"image"},flip:{name:"Flip",type:"choice",default:"none",priority:4.2,tab:"image",values:["none","horizontally","vertically"]},autoSvgSize:{name:"Auto SVG Size",type:"boolean",default:!1,priority:4.3,tab:"image",limit:!1}},local:{},watch:function(t,e){var a,r,n,o;if(i.inited)return i.upload!==t.upload&&t.upload&&lda.anicon.load(t.upload),a={none:[1,1],horizontally:[-1,1],vertically:[1,-1]}[t.flip]||[1,1],r=a[0],n=a[1],i.sizeg.style.transform="rotate("+(t.rotate||0)+"deg) scale("+r*t.scale+","+n*t.scale+")",i.colorlist.map(function(a,r){var n,o,p,d;if(n="c"+(r+1),o=[t[n],e[n]],p=o[0],d=o[1],p!==d)return a[1].map(function(t){if("#000000"!==ldColor.hex(i.mod.edit[n].default)||"#000000"!==ldColor.hex(p))return t[1].style[t[0]]=p;"#000000"!==ldColor.hex(window.getComputedStyle(t[1])[t[0]])&&(t[1].style[t[0]]="")})}),i.svg&&(t.background!==e.background&&(i.svg.style.background=t.background),o=["repeatCount","latency","order","speed","group","origin","dir"].map(function(i){return t[i]!==e[i]}).filter(function(t){return t}).length,o=t.animate&&(o||!i.animate||i.animateSig!==t.animate.id+JSON.stringify(t.animate.config)))?(i.animateSig=t.animate.id+JSON.stringify(t.animate.config),i.animate=t.animate,this.anitify(i.svg,t)):void 0},anitify:function(t,e){var a,r,n,o,p,d,l,u,m,g,s;return(a=e.animate).statify(i.anitgt.root),i.anitgt.all.map(function(t){return a.statify(t)}),i.anitgt.g.map(function(t){return a.statify(t)}),i.anitgt.root.offsetHeight,r=[i.svg.parentNode,i.svg.nextSibling],n=r[0],o=r[1],n.removeChild(i.svg),n.insertBefore(i.svg,o),"Viewport"===e.origin?(p=i.svg.getAttribute("viewBox"))?(d=p.split(" ").map(function(t){return+t.trim()}),l={x:d[0],y:d[1],width:d[2],height:d[3]}):l={x:0,y:0,width:e.size,height:e.size}:l=i.anitgt.root.getBBox(),u={dur:1/e.speed,animationDir:e.dir,repeat:e.repeatCount},"Whole Icon"===e.group?(m=i.anitgt.root,a.animateJs(m,0),a.animate(m,u),a.origin(m,l)):(g="No"===e.group?i.anitgt.all:i.anitgt.g,s=g.length,g.map(function(t,i){var r,n;return r="Normal"===e.order?i:"Reverse"===e.order?s-i-1:Math.floor(Math.random()*s),a.animateJs(t,0),a.animate(t,u),n=e.latency*(r/s)/e.speed,1!==u.repeat&&(n=-(1/e.speed-n)),t.style.animationDelay=n+"s","Layer"!==e.origin?a.origin(t,l):a.origin(t,t.getBBox())}))},dom:function(){}},"anicon"===i.favor&&(a.edit.upload={type:"upload",name:"Your Image",priority:1},(n=(r=a.edit).dir).priority=2,n.tab=null,n.hidden=!1,(n=r.palette).priority=3,n.tab="advanced",r.background.priority=1.2,r.transparent.priority=1.3,r.edgeSmoothing.priority=1.4,(n=r.speed).priority=2.2,n.weight=2,r.size.priority=2.3,r.scale.priority=2.4,r.repeatCount.priority=2.5,(n=r.animate).priority=1.1,n.weight=2,(n=r.group).priority=4.5,n.tab="advanced",(n=r.order).priority=4.6,n.tab="advanced",(n=r.origin).priority=4.7,n.tab="advanced",(n=r.latency).priority=4.8,n.tab="advanced",(n=r.frameCount).priority=4.9,n.tab="advanced"),ModExt.modextIcon={support:["svg","staticsvg","png","apng","pngs","gif"],edit:{},download:function(t){var i,a,r;return i=t.type,a=t.payload,t.mod,t.opt,"staticsvg"===i?(r=ld$.find(a,"svg",0),r=r.cloneNode(!0),e.unwrap(r,{recurse:!0}),smiltool.svgStatify(r),r):null},update:function(){var t,e;if(t=this.inner.style,t.width=this.mod.config.size+"px",t.height=this.mod.config.size+"px",(e=ld$.find(this.inner,"svg",0))&&(e.setAttribute("width",this.mod.config.size+"px"),e.setAttribute("height",this.mod.config.size+"px")),i.node&&!i.inited)return i.inited=!0,i.svg=e=ld$.find(i.node,"svg",0),e.parentNode.removeChild(e),e.style.background=this.mod.config.background,this.inner.innerHTML="",this.inner.appendChild(e),i.inner=this.inner}},ModManager.register(a)}});function import$(e,t){var n={}.hasOwnProperty;for(var i in t)n.call(t,i)&&(e[i]=t[i]);return e}ldc.register("modextAnicon",["error"],function(e){var t;return t=e.error,function(e){var n,i;return n=e,n.urlcache=null,i={id:"editor",type:"modextAnicon",init:function(){},config:{},edit:{upload:{type:"upload",name:"Your Image",priority:1.1},animate:{type:"submod",subtype:"animation",name:"Animation",default:"breath",priority:1.2,weight:2},background:{type:"color",name:"Background",default:"#fff",priority:1.3},palette:{type:"palette",hidden:!0,default:{colors:["#fff"],priority:1.1}},transparent:{type:"boolean",default:!0,priority:1.4},edgeSmoothing:{type:"boolean",name:"Smoothing",default:!0,priority:1.5},dir:{name:"Time Flow",type:"choice",priority:2.1,values:["normal","reverse"]},speed:{type:"number",priority:2.2,min:.01,max:10,default:1,step:.01,weight:2},size:{type:"number",min:1,max:800,step:1,default:47,priority:2.3,limitMax:48},width:{type:"number",hidden:!0},height:{type:"number",hidden:!0},scale:{type:"number",default:1,min:.01,max:2,step:.01,priority:2.4},frameCount:{name:"Frame Rate (fps)",type:"number",default:30,min:1,max:60,priority:3.1,tab:"image"},repeatCount:{name:"Repeat",type:"number",default:0,min:0,max:50,priority:2.5,label:{min:"∞"},exp:{output:.35,input:.5}},rotate:{name:"Rotation",type:"number",default:0,min:0,max:360,priority:3.1,tab:"image"},flip:{name:"Flip",type:"choice",default:"none",priority:3.2,tab:"image",values:["none","horizontally","vertically"]},gifGlobalPalette:{type:"boolean",name:"GIF Global Palette",default:!1,priority:3.9,tab:"image"}},watch:function(e,t,i){return n.upload!==e.upload&&e.upload&&lda.anicon.load(e.upload),["width","height"].map(function(t){if(e[t]!==e.size)return i.update(t,e.size)})},dom:function(){return'<circle cx="100" cy="100" r="50" fill="red"/>'}},ModExt.modextAnicon={support:["png","apng","pngs","gif"],update:function(){var e,i,r,a,o,l,p,u,d,m,s=this;return(e=this.mod.config).animate.setConfig({dur:1/e.speed,animationDir:e.dir}),i=this.inner.style,i.width=e.size+"px",i.height=e.size+"px",r=e.scale,a=import$({},e.edgeSmoothing?{img:"auto",svg:"auto"}:{img:"pixelated",svg:"crispedges"}),o="transform-origin:50px 50px",l=function(t){var n,i,l,p;return n={none:[1,1],horizontally:[-1,1],vertically:[1,-1]}[e.flip]||[1,1],i=n[0],l=n[1],s.inner.innerHTML='<?xml version="1.0" encoding="utf-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n     width="'+e.size+'px" height="'+e.size+'px" viewBox="0 0 100 100"\n     style="background:'+(e.background||"#fff")+";image-rendering:"+a.img+'">\n<g transform="translate(50 50) rotate('+(e.rotate||0)+") scale("+i*r+" "+l*r+') translate(-50 -50)">\n<image x="0" y="0" width="100" height="100" href="'+t+'" class="" style="'+o+'"/>\n</g>\n</svg>',p=ld$.find(s.inner,"image",0),s.mod.config.animate.animate(p)},p=function(e){return ldFile.fromURL(e,"text").then(function(e){var t;return t=e.result.replace(/shape-rendering=['"][^"' ]+?['"]/,"").replace(/shape-rendering:[^"'; ]+?/,"").replace(/<svg/,'<svg shape-rendering="'+a.svg+'" '),ldFile.fromFile(new Blob([t],{type:"image/svg+xml"}),"dataurl")})},u=!e.upload&&!n.upload||n.useSample?(m=n.urlcache)?Promise.resolve(m):debounce(100).then(function(){if(u.canceled)throw new ldError(999)}).then(function(){return p("/assets/img/p/animation/icon/fruits/apple.svg")}).then(function(e){return n.urlcache=e.result}).catch(t({ignore:[999]})):(d=n.upload?n.upload:e.upload[0].result,/svg/.exec(d.substring(0,15))?p(d).then(function(e){return e.result}):Promise.resolve(d)),(m=n.pendingPromise)&&(m.canceled=!0),n.pendingPromise=u,u.then(function(e){if(e&&!u.canceled)return l(n.upload=e)})}},ModManager.register(i)}});function in$(e,l){for(var n=-1,r=l.length>>>0;++n<r;)if(e===l[n])return!0;return!1}function import$(e,l){var n={}.hasOwnProperty;for(var r in l)n.call(l,r)&&(e[r]=l[r]);return e}ldc.register("svgutil",[],function(){var e,l,n,r,o,i;return e=function(e,l){return null==l&&(l={}),e&&e.classList&&e.classList.contains("ldl-layer")},l=function(e,l){return null==l&&(l={}),e&&e.classList&&e.classList.contains("ldl-ani")},n=function(r,o){var i,t,a,s,c,d,u,p,h,f,g,m;if(null==o&&(o={}),i={nal:[],gal:[],tl:[]},1!==r.nodeType)return i;if(t=r.nodeName.toLowerCase(),~["g","polygon","ellipse","rect","circle","line","path","polyline"].indexOf(t)&&!e(r,o)&&!l(r,o)){if(a=r.parentNode,s=a.parentNode,e(s)&&l(a))d=(c=[s,a])[0],u=c[1];else if(e(a)){for(d=a,u=ld$.create({ns:"svg",name:"g",className:["ldl-ani"]}),p=0,h=a.childNodes.length;p<h;++p)f=p,g=a.childNodes[0],a.removeChild(g),u.appendChild(g);a.appendChild(u)}else l(a)?(d=ld$.create({ns:"svg",name:"g",className:["ldl-layer"]}),u=a,s.insertBefore(d,a),s.removeChild(a),d.appendChild(a)):(u=ld$.create({ns:"svg",name:"g",className:["ldl-ani"]}),(d=ld$.create({ns:"svg",name:"g",className:["ldl-layer"]})).appendChild(u),a.insertBefore(d,r),a.removeChild(r),u.appendChild(r));o.underGroup||i.gal.push(u),"g"!==t&&i.nal.push(u),i.tl.push(d)}if(!in$(t,["clippath"])&&o.recurse)for(p=r.childNodes.length-1;p>=0;--p)f=p,m=n(r.childNodes[f],import$("g"===t?{underGroup:!0}:{},o)),["gal","nal","tl"].map(function(e){return i[e]=i[e].concat(m[e])});return i},r=function(n,o){var i,t,a,s,c,d,u,p,h,f,g=[];if(null==o&&(o={}),i=n.childNodes,e(n,o)||l(n,o)){for(a=(t=[n.parentNode,n])[0],s=t[1],c=t[2],d=[],u=0,p=i.length;u<p;++u)h=u,d.push(i[h]);for(c=d,u=i.length-1;u>=0;--u)f=i[h=u],n.removeChild(f),a.insertBefore(f,s),s=f;a.removeChild(n),i=c}if(o.recurse){for(u=i.length-1;u>=0;--u)h=u,g.push(r(i[h],o));return g}},o=function(e){return import$(e.style,{inlineSize:null,blockSize:null,pointerEvents:null,transformOrigin:null,perspectiveOrigin:null,height:"100%",width:"100%"})},i=function(e){var l,r,o;return l={colormap:{},all:[],g:[]},(r=function(e,n){var o,i,t,a,s,c,d=[];if(null==n&&(n=!1),1===e.nodeType){for(o=e.nodeName.toLowerCase(),["g","stop","polygon","ellipse","rect","circle","line","path","polyline"].indexOf(o)>0&&(i=window.getComputedStyle(e),["fill","stroke","stop-color"].map(function(n,r){var t,a,s;if(!/^(none|\s*url\()/.exec(t=i[n])&&!(1===r&&!i["stroke-width"]||2===r&&"stop"!==o))return((a=l.colormap)[s=ldColor.web(t)]||(a[s]=[])).push([n,e])})),t=0,s=(a=e.childNodes).length;t<s;++t)c=a[t],d.push(r(c,n||"g"===o));return d}})(e),o=n(e,{recurse:!0}),l.all=l.all.concat(o.nal),l.g=l.g.concat(o.gal),{colormap:l.colormap,nodes:{all:l.all,g:l.g}}},{analyze:i,wrap:n,unwrap:r,cleanup:o}});function import$(e,t){var n={}.hasOwnProperty;for(var i in t)n.call(t,i)&&(e[i]=t[i]);return e}!function(){var e,t;e="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSIjNjAzODEzIiBkPSJNNTcuNCAxNi4zYzQtNS40IDkuOS03IDE2LjUtOC4zIDEuOCAxLjkgMi4zIDQuMS42IDYuNy01LjggMS4yLTExLjEgMS45LTE1IDYuNC0yLjEgMi40LTMuOCA1LjEtNS4xIDgtLjYgMS40LTEuMiAyLjktMS42IDQuNC0uNCAxLjYtLjMgMy41LTIuMSAzLjktLjQtMy4zLjctNy40IDEuNi0xMC41IDEtMy43IDIuNy03LjQgNS4xLTEwLjZ6Ii8+PHBhdGggZmlsbD0iIzAwOTI0NSIgZD0iTTQ5LjUgMTguMmMtNS41LTYuNC0xNC41LTkuNi0yMi44LTgtLjMgMS43LjIgMy41IDEgNSAzLjEgNi40IDEwLjEgMTAuNiAxNy4yIDEwLjMgMS41LS4xIDMtLjMgNC4zLjIgMS40LjQgMi42IDEuOSAyLjIgMy4zIDEuNi0zLjYuNi03LjgtMS45LTEwLjh6Ii8+PHBhdGggZmlsbD0iI0Q5NkQ2RCIgZD0iTTgyIDQyLjVjMC0zLjUtLjQtNi45LTEtMTAuMi0xLjgtMS41LTMuOC0yLjctNi4zLTMuNkM2NC4yIDI0LjggNTEuNSAzNSA1MS41IDM1UzQwLjcgMjUuMyAyOSAyOC43QzE3LjMgMzIgMTMuNCA0NC4zIDEzLjQgNTRzNC4zIDE4LjQgMTEuMSAyNC43YzQuMSAzLjggOS4yIDYuNyAxNC45IDguNSAxIC4xIDEuOS4xIDIuOS4xIDIxLjkgMCAzOS43LTIwIDM5LjctNDQuOHoiLz48cGF0aCBmaWxsPSIjRkZGIiBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iNS43MDMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjUuMyA0MC44Yy00IDMuMi01LjMgMTEuNS0zLjggMTQuOSIvPjxlbGxpcHNlIHRyYW5zZm9ybT0icm90YXRlKC0zNC45MjUgMjQuNzgzIDY1LjA0NSkiIGZpbGw9IiNGRkYiIGN4PSIyNC44IiBjeT0iNjUiIHJ4PSIzLjMiIHJ5PSIzLjMiLz48cGF0aCBmaWxsPSIjQzEyNzJEIiBkPSJNODEgMzIuM2MuNyAzLjMgMSA2LjcgMSAxMC4yIDAgMjQuOC0xNy44IDQ0LjgtMzkuNyA0NC44LTEgMC0xLjktLjEtMi45LS4xIDMuOCAxLjIgNy44IDEuOCAxMiAxLjggMTAuNSAwIDIwLTMuOSAyNi45LTEwLjNzMTEuMi0xNSAxMS4yLTI0LjdjMC03LjYtMi0xNi4zLTguNS0yMS43eiIvPjwvc3ZnPg==",t='<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" r="14.671" fill="none" stroke="#e9e9e9" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;33" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.5s"/><animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.5s"/></circle><circle cx="50" cy="50" r="29.759" fill="none" stroke="#e9e9e9" stroke-width="2"><animate attributeName="r" repeatCount="indefinite" dur="1s" values="0;33" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline"/><animate attributeName="opacity" repeatCount="indefinite" dur="1s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline"/></circle></svg>',ldc.register("icon",["auth","ldcvmgr","assetmgr","viewLocals","editor","payItem","notify","error","modextIcon","modextAnicon","svgutil"],function(n){var i,o,r,a,l,d,c,u;return i=n.auth,o=n.ldcvmgr,n.assetmgr,r=n.viewLocals,a=n.editor,n.payItem,n.notify,l=n.error,d=n.modextIcon,c=n.modextAnicon,u=n.svgutil,function(n){var s,g,m,f,p,y,M;return null==n&&(n={}),s=import$({favor:"icon"},n),s.lded=g=new ldEditor({root:".lded",view:".lded .viewer",renderer:m,palconfig:a.palconfig,modalconfig:a.modalconfig,ui:"anicon"===s.favor?{fixed:!0,size:"sm",class:"lded-sparse compact",tab:{class:"nav-pills"}}:{fixed:!0,size:"sm",class:"lded-sparse",tab:{class:"nav-pills"}},action:{metainfo:function(){return"generated by https://loading.io/"},download:function(e){var t,n,i,o;return t=e.act,n=e.lded,"png"===t||"staticsvg"===t?Promise.resolve(!0):"anicon"!==s.favor||n.isLimited()||"gif"!==t?(i="png"===t||"staticsvg"===t?"attribute":"pay",o={type:"icon",id:s.slug,name:s.mod.name},a.action.download({act:t,item:o,type:i,panel:"anicon"===s.favor?"subscription":"pay",lded:n})):Promise.resolve(!0)},gopro:function(){return a.action.gopro()},patchEdit:function(e){var t,n,i=[];for(t in e)(n=e[t]).priority||i.push(n.priority=1.5);return i},setPro:function(e){return a.setPro(e,import$({lded:g},"anicon"===s.favor?{showTaglet:["pngs","apng","svg"]}:{}))},save:function(e){var t;return t={lded:g,params:e,key:s.key,name:s.mod.name,type:s.favor,payload:{config:e.config}},s.slug&&(t.payload.slug=s.slug),("anicon"===s.favor&&s.upload?ldFile.fromURL(s.upload,"blob").then(function(e){return t.upload=e.file}):Promise.resolve()).then(function(){return a.action.save(t)}).then(function(e){var t;if(null==e&&(e={}),t=e.key)return s.key=t})}}}),g.renderer=m=new ModRenderer(".lded .viewer",{choosefont:g.choosefont}),ldc.on("auth.change",function(e){var t;return t=e.user,i.userinfo(t).then(function(e){return g.setPro(e.isPro)})}),f=function(e){var n,i,o,r,a;return n=e.slug,i=e.config,o=e.name,s.mod.name=o,(r=M.get("sharelink"))&&(r.value=window.location.origin+"/icon/"+n),(r=M.get("sharelink-asset"))&&(r.value=window.location.origin+"/asset/"+y.key),(r=M.get("openlink"))&&r.setAttribute("href",window.location.origin+"/icon/"+n),a=null!=n?"/s/icon/"+n+".svg":null,s.slug=n,g.setLoading("main",!0),debounce(500).then(function(){if(s.slug!==n)throw new ldError(999)}).then(function(){return s.upload?ldFile.fromURL(s.upload,"text").then(function(e){return e.result}):a?ld$.fetch(a,{},{type:"text"}):Promise.resolve(t)}).then(function(e){var t,o,r,a,l,d,c,f,p,I,L,v,N,h,j,x,S;if(s.slug===n){if(s.inited=!1,m.clear(),(t=(s.node||(s.node={})).parentNode)&&t.removeChild(s.node),s.node=o=ld$.create({name:"div",style:{opacity:0,height:0,width:0,overflow:"hidden"}}),s.colormap={},s.anitgt={all:[],g:[],root:null},o.innerHTML=DOMPurify.sanitize(e,{ADD_TAGS:["d:name","d:slug","d:license","d:tags","use"],ADD_ATTR:["xmlns:d"],ADD_DATA_URI_TAGS:["image"]}),document.body.appendChild(o),(r=M.get("tags"))&&(r.innerHTML="",((o.querySelector("metadata d\\:tags")||{}).textContent||"").split(",").splice(0,5).map(function(e){return e.trim()}).map(function(e,t){return r.appendChild(ld$.create({name:"a",className:["ld","ld-float-ltr-in"],style:{animationDelay:t/20+"s"},text:e,attr:{href:"/icon/tag/"+encodeURIComponent(e)}}))})),a=ld$.find(o,"svg",0),(l=a.childNodes[0])&&1===l.nodeType&&l.classList.contains("ldl-scale")){for(d=l,c=l.childNodes.length-1;c>=0;--c)f=c,p=l.childNodes[f],l.removeChild(p),a.insertBefore(p,d),d=p;I=l,a.removeChild(l)}for(u.cleanup(a),L=u.analyze(a),s.colormap=L.colormap,import$(s.anitgt,L.nodes),s.mod.local.anitgt=s.anitgt,I||(I=ld$.create({ns:"svg",name:"g",className:["ldl-scale"],style:{transformOrigin:"50% 50%"}})),v=ld$.create({ns:"svg",name:"g",className:["ldl-ani"]}),I.appendChild(v),c=a.childNodes.length-1;c>=0;--c)f=c,(p=a.childNodes[f]).parentNode.removeChild(p),v.insertBefore(p,v.childNodes[0]);s.anitgt.root=v,s.sizeg=I,a.appendChild(I),a.getAttribute("viewBox")||(N=s.sizeg.getBBox(),a.setAttribute("viewBox",N.x+" "+N.y+" "+N.width+" "+N.height)),h=[];for(j in s.mod.edit)h.push(j);return h.filter(function(e){return/c\d+/.exec(e)}).map(function(e){var t,n;return n=(t=s.mod.edit)[e],delete t[e],n}),s.colorlist=x=function(){var e,t=[];for(j in e=s.colormap)S=e[j],t.push([ldColor.hsl(j),S]);return t}(),(!y||y.key>=303327)&&x.sort(function(e,t){return t[0].l-e[0].l}),x.map(function(e,t){return s.mod.edit["c"+(t+1)]=import$({name:"Color "+(t+1),type:"color",default:ldColor.web(e[0])},"icon"===s.favor?{priority:"1.1"+(10+t),tab:null}:{priority:"3.1"+(10+t),tab:"advanced"})}),s.mod.edit.palette.default=null,"anicon"===s.favor&&(s.mod.edit.size.limitMax=48,s.mod.edit.group.limit=["Whole Icon"]),m.initMod(s.mod).then(function(){return g.setMod(s.mod,i)}).then(function(){return debounce(100)}).then(function(){return g.setLoading("main",!1)})}}).catch(l({ignore:[999]}))},p=function(e){var t,n,i,r,l;return t=e.type,n=e.id,i=e.slug,r=e.config,l=e.name,"icon"===s.favor&&g.root.classList.toggle("tertiary","modextIcon"===t),ModManager.load(t,n).catch(function(){return o.get("mod-load-failed")}).then(function(e){return s.mod=e}).then(function(){return"modextAnicon"===t?m.initMod(s.mod).then(function(){return g.setMod(s.mod)}).then(function(){return g.setConfig(r)}).then(function(){return m.update()}):f({slug:i,config:r,name:l||"icon"})}).then(function(){return a.grantType("modextIcon"===t?{id:i,type:"icon"}:null)}).then(function(e){return g.setPro(!!e)})},ldc.action("icon",{load:function(e,t,n){return null==t&&(t="icon"),p({type:"modextIcon",id:"editor",slug:e,name:t,config:n})},setConfig:function(e){return null==e&&(e={}),g.setConfig(e)}}),ldc.action("anicon",{load:function(e,t){var n,i,o;if(null==t&&(t={}),s.url=null,s.useSample=!1,s.upload=((e||[])[0]||{}).result||"",n=!!/^data:image\/svg\+xml;/.exec(s.upload),t.group="Whole Icon",void 0!==y&&null!==y&&null!=y.key){delete(i=g.getConfig()).upload,delete i.palette;for(o in i)i[o],/^c\d+$/.exec(o)&&delete i[o];t=import$(t,i)}return p(n?{type:"modextIcon",id:"editor",config:t}:{type:"modextAnicon",id:"editor",config:t})}}),null!=d&&d(s),null!=c&&c(s),r&&r.payload?(s.asset=y=r,s.key=y.key,"anicon"===s.favor?ldFile.fromURL("/s/asset/upload/"+y.key,"dataurl").then(function(e){var t;return t=e.result,"P"===/base64,(.{1})/.exec(t)[1]&&(t=t.replace(/application\/octet-stream/,"image/svg+xml")),lda.anicon.load([{result:t}],y.payload.config)}):p({type:"modextIcon",id:"editor",slug:y.payload.slug,config:y.payload.config})):"anicon"===s.favor?lda.anicon.load([{result:e}]):p({type:"modextIcon",id:"editor"}),g.root.classList.toggle("compact","anicon"===s.favor),M="anicon"===s.favor?new ldView({root:document,handler:{}}):new ldView({root:document,handler:{tags:function(){},sharelink:function(){},share:function(e){var t;return(t=e.node).addEventListener("click",function(){var e;return(e=ld$.find(t,"img",0)).setAttribute("src",e.getAttribute("src").replace(/\?.+$/,"")+"?"+Math.random().toString(36).substring(2))}),new ClipboardJS(t).on("success",function(){return t.classList.add("tip-on"),debounce(2e3).then(function(){return t.classList.remove("tip-on")})})}}})}})}();